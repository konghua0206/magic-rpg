:root {
  --primary: #9b5cff;
  --secondary: #5a2cff;
  --bg-dark: #0d0818;
  --card-bg: rgba(255, 255, 255, 0.08);
  --rarity-0: #ffffff;
  --rarity-1: #3498db;
  --rarity-2: #9b59b6;
  --rarity-3: #f1c40f;
}

* { box-sizing: border-box; } 

body {
  margin: 0;
  background: #0d0818 linear-gradient(180deg, #1a0b2e 0%, #0d0818 100%) fixed;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  color: #fff;
  display: flex;
  min-height: 100vh;
  overflow-x: hidden;
}

/* --- 側邊選單 --- */
.sidebar {
  width: 70px;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  height: 100vh;
  position: fixed;
  left: 0; top: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 20px;
  border-right: 1px solid rgba(255,255,255,0.1);
  z-index: 100;
}

.nav-item {
  width: 50px; height: 50px; margin-bottom: 20px; border-radius: 12px;
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  cursor: pointer; font-size: 10px; color: rgba(255,255,255,0.5);
  transition: 0.3s;
}
.nav-item span { font-size: 20px; }
.nav-item.active { background: var(--primary); color: #fff; box-shadow: 0 0 15px var(--primary); }

/* --- 主要內容區 --- */
.main-wrapper {
  margin-left: 70px;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-width: 0;
}

.main-content {
  width: 100%; 
  max-width: 480px; 
  padding: 15px;
}

.page { display: none; }
.page.active { display: block; animation: fadeIn 0.3s ease-out; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* --- 核心元件 --- */
.card { 
  background: var(--card-bg); border-radius: 20px; padding: 20px; 
  margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.05);
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.magic { 
  font-size: 36px; font-weight: bold; text-align: center;
  background: linear-gradient(to bottom, #fff, var(--primary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 15px rgba(155, 92, 255, 0.5);
  margin-top: 10px;
}

/* --- 裝備九宮格佈局 --- */
/* 1. 容器：固定寬度與置中 */
.equip-grid-new {
  display: grid;
  grid-template-columns: repeat(3, 70px); 
  gap: 22px 8px; 
  justify-content: center; 
  margin: 15px auto; 
}

/* 2. 格子主體 */
.equip-slot {
  width: 70px; 
  height: 70px; 
  background: rgba(0, 0, 0, 0.4); 
  border: 1px dashed rgba(155, 92, 255, 0.5);
  border-radius: 14px; 
  display: flex; 
  justify-content: center; 
  align-items: center; 
  font-size: 32px; 
  position: relative; /* 必須為相對定位，讓 img 和 ::after 參考 */
  cursor: pointer;
  transition: all 0.2s;
  z-index: 1;
}

/* 3. 圖片定位：新增 position: absolute 是關鍵 */
.equip-slot img {
  position: absolute; /* 讓圖片浮動在格子正中央，不影響文字佈局 */
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%); /* 精確居中 */
  width: 80%; 
  height: 80%;
  object-fit: contain;
  pointer-events: none; 
  z-index: 2;
}

/* 4. 文字標籤 */
.equip-slot::after { 
  content: attr(data-label); 
  position: absolute; 
  bottom: -16px; 
  font-size: 11px; 
  color: #a29bfe; 
  white-space: nowrap; 
  letter-spacing: 0.5px;
  pointer-events: none;
}

/* 5. 占用狀態：隱藏 Emoji 的關鍵 */
.equip-slot.occupied { 
  border: 2px solid var(--primary); 
  background: rgba(155, 92, 255, 0.15); 
  box-shadow: 0 0 15px rgba(155, 92, 255, 0.3);
  /* 當 class 包含 occupied 時，原本格子內的文字(Emoji)會變透明 */
  color: transparent !important; 
}

/* --- 屬性與數值 --- */
.attr { 
  display: flex; justify-content: space-between; align-items: center; 
  margin: 8px 0; background: rgba(255,255,255,0.04); 
  padding: 8px 12px; border-radius: 10px;
}
.small { font-size: 12px; color: #888; }

/* --- 按鈕樣式 --- */
button {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: #fff; border: none; border-radius: 12px; padding: 12px;
  font-weight: bold; cursor: pointer; transition: 0.2s;
  width: 100%; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}
button:active { transform: scale(0.96); box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

/* --- 背包物品 --- */
.item-card {
  background: rgba(255,255,255,0.06); border-radius: 12px; padding: 12px;
  margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;
  border-left: 4px solid #fff; transition: 0.2s;
}
.sell-btn { background: #e74c3c !important; font-size: 11px; padding: 6px 12px; width: auto; margin: 0; }

/* --- 彈窗優化 --- */
.modal-overlay {
  display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.9); z-index: 200; justify-content: center; align-items: center;
  backdrop-filter: blur(5px);
}
/* 彈窗遮罩：加入動態模糊與深色漸層 */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: radial-gradient(circle, rgba(20, 15, 30, 0.85) 0%, rgba(0, 0, 0, 0.95) 100%);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(8px);
    transition: all 0.3s ease;
}

/* 卡片本體：美化邊框與陰影 */
.modal-card {
    background: #1a1525;
    background-image: linear-gradient(145deg, #1e182e, #16111f);
    border: 2px solid rgba(138, 43, 226, 0.4); /* 柔和的紫色邊框 */
    border-radius: 24px;
    padding: 25px;
    width: 280px; /* 寬度稍微縮小以利並排 */
    text-align: center;
    color: #e0e0e0;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5), 
                0 0 15px rgba(138, 43, 226, 0.2); /* 外發光 */
    position: relative;
    overflow: hidden;
    transition: transform 0.2s ease;
}

/* 裝備對比標題（當前裝備 / 目標裝備） */
.compare-label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--primary);
    margin-bottom: 10px;
    opacity: 0.8;
}

/* 稀有度文字：發光效果 */
.modal-rarity {
    font-size: 12px;
    font-weight: 900;
    margin-bottom: 5px;
    text-shadow: 0 0 8px currentColor;
}

/* 屬性區塊：區分左右對比的條目 */
.modal-stats {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    padding: 15px;
    margin: 15px 0;
    text-align: left;
    font-family: 'Courier New', Courier, monospace; /* 數值對齊更有遊戲感 */
    border: 1px solid rgba(255, 255, 255, 0.05);
}

/* 按鈕美化 */
#unequipBtn {
    width: 100%;
    padding: 12px;
    border-radius: 12px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
}

#unequipBtn:hover {
    transform: translateY(-2px);
    filter: brightness(1.2);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* 對比模式下的左側卡片特別處理（稍微縮小且低調） */
#compareCard {
    border-style: dashed;
    border-color: rgba(255, 255, 255, 0.2);
    transform: scale(0.95);
    background: #15111d;
}

/* 手機版自動改為垂直排列 */
@media (max-width: 600px) {
    .modal-overlay > div {
        flex-direction: column !important;
        gap: 20px !important;
    }
    .modal-card {
        width: 85%;
        padding: 20px;
    }
}

/* --- 名稱輸入框 --- */
#nameInput { 
  background: rgba(0,0,0,0.6); border: 1px solid var(--primary); 
  color: #fff; border-radius: 6px; padding: 4px 10px; 
  text-align: center; width: 120px; font-size: 16px;
}
#nameDisplay {
  font-size: 60px;           /* 增大字體 */
  font-weight: 900;          /* 極粗體 */
  color: #fff;               /* 白色字體 */
  text-shadow: 0 0 10px var(--primary), 0 0 20px var(--primary); /* 紫色發光 */
  display: block;            /* 確保佔據整列 */
  margin-bottom: 5px;        /* 與下方的距離 */
  letter-spacing: 2px;       /* 字距微調，更有質感 */
}

/* 美化 BOSS 列表捲軸 */
#bossList::-webkit-scrollbar {
  height: 6px;
}
#bossList::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 10px;
}
#bossList::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 10px;
}

/* 技能圖標飄浮動畫 */
@keyframes skill-float-up {
  0% {
    transform: translate(-50%, 0) scale(0.3); /* 圖片從較小開始噴出 */
    opacity: 0;
  }
  25% {
    transform: translate(-50%, -40px) scale(1.1); /* 噴射到高點，稍微放大 */
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -120px) scale(1); /* 緩慢漂浮並消失 */
    opacity: 0;
  }
}

.skill-popup {
  position: absolute;
  pointer-events: none;
  z-index: 1000;
  /* 移除字體大小，改用 flex 容器控制圖片 */
  display: flex;
  align-items: center;
  justify-content: center;
  
  /* 動畫設定 */
  animation: skill-float-up 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
  
  /* 初始過濾器：確保圖片在 JS 加載前不會有奇怪的殘影 */
  will-change: transform, opacity; 
}

/* 針對內含圖片的特別設定 */
.skill-popup img {
  width: 60px;  /* 你可以根據需求調整圖片大小 */
  height: 60px;
  object-fit: contain;
  /* 讓圖片邊緣清晰，並增加一點基礎亮度 */
  filter: brightness(1.1);
}

/* 如果你保留部分 Emoji，這行可以確保它們依然好看 */
.skill-popup span {
  font-size: 40px;
  font-family: "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
}


/* =========================================================
   Skills UI (Replace All)
   ========================================================= */

/* 列表容器 */
.skill-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* 技能卡本體 */
.skill-card,
#skillList .item-card {
  transition: background 0.2s ease, transform 0.2s ease, border-color 0.2s ease;
  border: 1px solid rgba(255, 255, 255, 0.10);
  border-left: 4px solid #555;
  display: flex;
  align-items: stretch;
  padding: 12px;
  background: rgba(255,255,255,0.05);
  border-radius: 10px;
  gap: 12px;
}

/* hover 只給桌機，避免手機點擊時抖動 */
@media (hover: hover) and (pointer: fine) {
  .skill-card:hover,
  #skillList .item-card:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateX(5px);
  }
}

/* icon 外框（沿用你原本風格） */
.skill-icon-box,
.skill-icon {
  width: 45px;
  height: 45px;
  background: #1a1a1a;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
  flex-shrink: 0;
}

.skill-icon-box img,
.skill-icon-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  border-radius: 8px;
}

/* 主內容區 */
.skill-main {
  flex: 1;
  min-width: 0; /* ✅ 防止文字把 flex 撐爆 */
}

/* 標題列 */
.skill-title-row {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap; /* ✅ 小螢幕自動換行 */
}

.skill-name {
  font-weight: 800;
  font-size: 15px;
  line-height: 1.2;
}

.skill-badge {
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.06);
  color: #ddd;
  white-space: nowrap;
}

.skill-meta {
  font-size: 11px;
  color: #aaa;
  white-space: nowrap; /* 桌機更整齊 */
}

/* 描述文字 */
.skill-desc {
  color: #cfcfcf;
  margin-top: 6px;
  line-height: 1.35;
  overflow-wrap: anywhere; /* ✅ 長字/材料可斷行 */
  word-break: break-word;
}

/* 升級資訊盒 */
.skill-upgrade-box {
  margin-top: 8px;
  padding: 8px 10px;
  border-radius: 8px;
  background: rgba(0,0,0,0.20);
  border: 1px solid rgba(255,255,255,0.10);
}

.skill-upgrade-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.skill-upgrade-level,
.skill-upgrade-mana,
.skill-upgrade-mats {
  font-size: 12px;
  color: #ddd;
  overflow-wrap: anywhere;
  word-break: break-word;
}

.skill-upgrade-mana span,
.skill-upgrade-mats span {
  color: #f1c40f;
}

.skill-upgrade-warn {
  margin-top: 6px;
  font-size: 11px;
  color: #e67e22;
}

/* 未學會資訊盒 */
.skill-learn-box {
  margin-top: 8px;
  padding: 8px 10px;
  border-radius: 8px;
  background: rgba(0,0,0,0.15);
  border: 1px solid rgba(255,255,255,0.08);
}

.skill-learn-cost,
.skill-learn-mats {
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* 右側按鈕區 */
.skill-actions {
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex-shrink: 0;
}

.skill-actions button,
.item-card button {
  border-radius: 8px;
  transition: filter 0.2s ease, opacity 0.2s ease, transform 0.05s ease;
}

.item-card button:active,
.skill-actions button:active {
  filter: brightness(0.85);
  transform: translateY(1px);
}

/* 桌機按鈕寬度 */
.skill-actions button {
  width: 86px;
  padding: 8px;
  font-size: 12px;
}

/* =========================================================
   Mobile Responsive (核心修復)
   ========================================================= */
@media (max-width: 520px) {
  /* 卡片改直排，避免內容被擠爆 */
  .skill-card,
  #skillList .item-card {
    flex-direction: column;
    gap: 10px;
    padding: 12px;
  }

  /* icon 稍微大一點更好點 */
  .skill-icon-box,
  .skill-icon {
    width: 48px;
    height: 48px;
    border-radius: 10px;
  }

  .skill-icon-box img,
  .skill-icon-img {
    border-radius: 10px;
  }

  /* 標題/描述字體稍微調整 */
  .skill-name { font-size: 16px; }
  .skill-desc { font-size: 13px; }

  /* meta 不要硬撐一行，讓它可換行 */
  .skill-meta { white-space: normal; }

  /* 升級 row 改成上下排（不擠成一行） */
  .skill-upgrade-row {
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
  }

  /* 按鈕改橫排平均分配 */
  .skill-actions {
    width: 100%;
    flex-direction: row;
    gap: 8px;
  }

  .skill-actions button {
    width: 100%;
    flex: 1;
    padding: 10px 8px;
    font-size: 13px;
    border-radius: 10px;
  }

  /* 如果只有 1 顆按鈕（未學會只顯示領悟），讓它看起來也正常 */
  .skill-actions button:only-child {
    flex: none;
    width: 100%;
  }
}

/* 更小螢幕再壓一點間距 */
@media (max-width: 380px) {
  .skill-card,
  #skillList .item-card {
    padding: 10px;
    gap: 8px;
  }
  .skill-actions { gap: 6px; }
  .skill-actions button { padding: 10px 6px; font-size: 12px; }
}



/* 裝備加成文字樣式 */
.bonus-text {
  color: #2ecc71; /* 亮綠色 */
  font-size: 0.85em;
  margin-left: 4px;
  font-weight: bold;
}

/* --- 版權 --- */
.copyright-notice {
  position: fixed;
  bottom: 10px;        /* 距離底部 10 像素 */
  left: 70px;          /* 避開你的側邊選單寬度 */
  right: 0;
  text-align: center;
  font-size: 10px;     /* 小字體 */
  color: rgba(255, 255, 255, 0.3); /* 半透明白色，不干擾視覺 */
  z-index: 50;         /* 確保在內容之上，但在彈窗之下 */
  pointer-events: none; /* 讓這行字不影響點擊操作 */
  letter-spacing: 1px;
}

/* 手機版微調：如果你的側邊欄在手機上會隱藏或變動，可以調整 left */
@media (max-width: 600px) {
  .copyright-notice {
    left: 0;
    bottom: 5px;
  }
}


